<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>爆炸轮播</title>
		<style type="text/css">
			#box{
				width: 700px;
				height: 400px;
				margin: 100px auto;
				background-image: url(img/1.jpg);
				transform-style: preserve-3d;
				perspective: 800px;
			}
			.kuai{
				width: 100px;
				height: 100px;
				float: left;
				background-image: url(img/0.jpg);
			}
		</style>
	</head>
	<body>
		<div id="box"></div>
		<script type="text/javascript">
			var oBox=document.querySelector("#box");
			
			var rows=4;
			var cols=7;
			for(var row=0;row<rows;row++){
				for(var col=0;col<cols;col++){
					oDiv=document.createElement('div');
					oDiv.classList.add('kuai');
					oBox.appendChild(oDiv);
					oDiv.style.backgroundPosition=`${-col*100}px ${-row*100}px`;
				}
			}
			var aBlock=document.querySelectorAll('.kuai');
			var iNow=0;
			var bSin=false;
			window.onclick = function(){
				if(bSin) return;
				bSin=true;
				aBlock.forEach(function(oBlock,index){
					var delay = parseInt(Math.random()*300);
					oBlock.style.opacity = 0;
					oBlock.style.transform = `translateZ(400px) rotateX(-180deg) rotateY(180deg)`;
					oBlock.style.transition = `.4s ${delay}ms`;
				})
				setTimeout(function(){
					iNow++;
					aBlock.forEach(function(oBlock,index){
						oBlock.style.opacity = 1;
						oBlock.style.transform = ``;
						oBlock.style.transition = ``;
						oBox.style.backgroundImage='url(img/'+(iNow+1)%3+'.jpg)';
						oBlock.style.backgroundImage='url(img/'+iNow%3+'.jpg)';
					})
					bSin=false;
				},700)
				
			}
		</script>
	</body>
</html>
